using Core.Models.Vulnerabilities;

namespace Infrastructure.Provider.Interface;

/// <summary>
/// Provides vulnerability information for packages within a specified ecosystem.
/// </summary>
public interface IVulnerabilityProvider
{
    /// <summary>
    /// Retrieves vulnerabilities for the given packages in the specified ecosystem.
    /// </summary>
    /// <param name="ecosystem">The package ecosystem (e.g., npm, maven).</param>
    /// <param name="packages">A dictionary of package names and their versions.</param>
    /// <returns>A task that returns a collection of vulnerable packages found.</returns>
    Task<IReadOnlyCollection<VulnerablePackage>> GetVulnerabilitiesAsync(string ecosystem, IReadOnlyDictionary<string, string> packages);
}