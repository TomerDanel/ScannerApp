using Core.Models.Vulnerabilities;
using Infrastructure.Models.GithubVulnerabilities;

namespace Infrastructure.Handlers.Interface;

/// <summary>
/// Processes vulnerability nodes to determine applicable vulnerabilities for a specific package version.
/// </summary>
public interface IProcessVulnerabilityHandler
{
    /// <summary>
    /// Filters and converts vulnerability nodes that affect the specified package version.
    /// </summary>
    /// <param name="nodes">The list of vulnerability nodes to process.</param>
    /// <param name="version">The package version to evaluate.</param>
    /// <returns>A collection of applicable vulnerabilities for the given version.</returns>
    IReadOnlyCollection<Vulnerability> ProcessVulnerabilityNodes(IReadOnlyCollection<VulnerabilityNode> nodes, string version);
}